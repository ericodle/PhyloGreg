from collections import defaultdict
import matplotlib.pyplot as plt

def parse_fasta(filename):
    """
    Parses a FASTA file and returns a dictionary of sequence IDs and sequences.
    """
    seqs = defaultdict(str)
    with open(filename, 'r') as f:
        current_id = ''
        for line in f:
            line = line.strip()
            if line.startswith('>'):
                current_id = line[1:]
            else:
                seqs[current_id] += line
    return seqs

def get_stats(seqs):
    """
    Calculates basic statistics (length, GC content) for each sequence in the given dictionary of sequences.
    """
    stats = {}
    for id, seq in seqs.items():
        length = len(seq)
        gc_content = (seq.count('G') + seq.count('C')) / length
        stats[id] = (length, gc_content)
    return stats

def plot_stats(stats):
    """
    Plots histograms of the lengths and GC contents of the given sequences.
    """
    lengths = [length for length, gc_content in stats.values()]
    gc_contents = [gc_content for length, gc_content in stats.values()]

    fig, axs = plt.subplots(1, 2, figsize=(10, 5))
    axs[0].hist(lengths, bins=50)
    axs[0].set_xlabel('Sequence Length')
    axs[0].set_ylabel('Frequency')
    axs[1].hist(gc_contents, bins=50)
    axs[1].set_xlabel('GC Content')
    axs[1].set_ylabel('Frequency')
    plt.show()

filename = 'sequences.fasta'
seqs = parse_fasta(filename)
stats = get_stats(seqs)
plot_stats(stats)
