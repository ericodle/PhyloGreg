from Bio import SeqIO
import numpy as np
import matplotlib.pyplot as plt

# Read in the FASTA file
sequences = list(SeqIO.parse("arb-silva.de_2023-04-16_id1249118.fasta", "fasta"))

# Calculate some descriptive statistics for each sequence
lengths = np.array([len(seq) for seq in sequences])
gc_content = np.array([100 * (seq.seq.count('G') + seq.seq.count('C')) / len(seq) for seq in sequences])
num_nucleotides = np.array([seq.seq.count('A') + seq.seq.count('C') + seq.seq.count('G') + seq.seq.count('T') for seq in sequences])

# Create a figure with three subplots
fig, axs = plt.subplots(1, 3, figsize=(15, 5))

# Plot a histogram of sequence lengths
axs[0].hist(lengths, bins=50)
axs[0].set_xlabel("Sequence Length")
axs[0].set_ylabel("Frequency")
axs[0].set_title("Sequence Lengths")

# Plot a histogram of GC content
axs[1].hist(gc_content, bins=50)
axs[1].set_xlabel("GC Content (%)")
axs[1].set_ylabel("Frequency")
axs[1].set_title("GC Content")

# Plot a histogram of total nucleotide count
axs[2].hist(num_nucleotides, bins=50)
axs[2].set_xlabel("Total Nucleotides")
axs[2].set_ylabel("Frequency")
axs[2].set_title("Total Nucleotides")

# Show the plot
plt.show()
